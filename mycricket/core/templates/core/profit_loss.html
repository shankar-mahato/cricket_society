{% extends 'core/base.html' %}

{% block title %}Profit & Loss{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Profit & Loss Report</h1>
    <p>View your betting performance and profit/loss summary</p>
</div>

<div class="card">
    <div class="card-header">
        <h2>Summary</h2>
    </div>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 24px;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">Total Bets</div>
            <div style="font-size: 28px; font-weight: 700;">₹{{ total_bets|floatformat:2 }}</div>
        </div>
        <div style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">Total Winnings</div>
            <div style="font-size: 28px; font-weight: 700;">₹{{ total_winnings|floatformat:2 }}</div>
        </div>
        <div style="background: linear-gradient(135deg, {% if total_profit_loss >= 0 %}#48bb78{% else %}#f56565{% endif %} 0%, {% if total_profit_loss >= 0 %}#38a169{% else %}#e53e3e{% endif %} 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 14px; opacity: 0.9; margin-bottom: 8px;">Net Profit/Loss</div>
            <div style="font-size: 28px; font-weight: 700;">{% if total_profit_loss >= 0 %}+{% endif %}₹{{ total_profit_loss|floatformat:2 }}</div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2>Session Details</h2>
    </div>
    {% if session_data %}
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Match</th>
                    <th>Status</th>
                    <th>Bet Amount</th>
                    <th>Winnings</th>
                    <th>Profit/Loss</th>
                </tr>
            </thead>
            <tbody>
                {% for data in session_data %}
                <tr>
                    <td>
                        <strong>{{ data.match.team_a.name }} vs {{ data.match.team_b.name }}</strong><br>
                        <small style="color: #718096;">Session #{{ data.session.id }}</small>
                    </td>
                    <td>
                        <span class="badge {% if data.status == 'completed' %}badge-success{% elif data.status == 'live' %}badge-warning{% else %}badge-secondary{% endif %}">
                            {{ data.session.get_status_display }}
                        </span>
                    </td>
                    <td style="font-weight: 600;">₹{{ data.bet_amount|floatformat:2 }}</td>
                    <td style="font-weight: 600; color: #48bb78;">₹{{ data.winnings|floatformat:2 }}</td>
                    <td style="font-weight: 600; color: {% if data.profit_loss >= 0 %}#48bb78{% else %}#f56565{% endif %};">
                        {% if data.profit_loss >= 0 %}+{% endif %}₹{{ data.profit_loss|floatformat:2 }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <p style="text-align: center; padding: 40px; color: #718096;">No betting sessions found</p>
    {% endif %}
</div>
{% endblock %}

