{% extends 'core/dl/base.html' %}

{% block title %}User Statement{% endblock %}

{% block page_title %}Statement - {{ end_user.username }}{% endblock %}

{% block extra_css %}
<style>
    .summary-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
    }
    .summary-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 12px;
        padding: 24px;
        color: white;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .summary-card.credits {
        background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
    }
    .summary-card.debits {
        background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
    }
    .summary-card.balance {
        background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
    }
    .summary-card-label {
        font-size: 14px;
        opacity: 0.9;
        margin-bottom: 8px;
        font-weight: 600;
    }
    .summary-card-value {
        font-size: 32px;
        font-weight: 700;
    }
    .table-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        overflow: hidden;
        border: 1px solid #e2e8f0;
    }
    .table-header {
        padding: 24px;
        border-bottom: 2px solid #e2e8f0;
    }
    .table-header h2 {
        margin: 0;
        color: #2d3748;
        font-size: 20px;
        font-weight: 700;
    }
    .table-wrapper {
        overflow-x: auto;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    thead {
        background: #f7fafc;
    }
    th {
        padding: 16px 24px;
        text-align: left;
        font-weight: 600;
        color: #2d3748;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border-bottom: 2px solid #e2e8f0;
    }
    td {
        padding: 16px 24px;
        border-bottom: 1px solid #e2e8f0;
        color: #4a5568;
    }
    tr:hover {
        background: #f7fafc;
    }
    .badge {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
    }
    .badge-credit {
        background: #d4edda;
        color: #155724;
    }
    .badge-debit {
        background: #f8d7da;
        color: #721c24;
    }
    .amount-positive {
        color: #48bb78;
        font-weight: 600;
    }
    .amount-negative {
        color: #f56565;
        font-weight: 600;
    }
    
    @media (max-width: 768px) {
        .summary-cards {
            grid-template-columns: 1fr;
        }
        .table-wrapper {
            overflow-x: auto;
        }
        th, td {
            padding: 12px 16px;
            font-size: 12px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="summary-cards">
    <div class="summary-card balance">
        <div class="summary-card-label">Current Balance</div>
        <div class="summary-card-value">₹{{ current_balance|floatformat:2 }}</div>
    </div>
    <div class="summary-card credits">
        <div class="summary-card-label">Total Credits</div>
        <div class="summary-card-value">₹{{ total_credits|floatformat:2 }}</div>
    </div>
    <div class="summary-card debits">
        <div class="summary-card-label">Total Debits</div>
        <div class="summary-card-value">₹{{ total_debits|floatformat:2 }}</div>
    </div>
</div>

<div class="table-container">
    <div class="table-header">
        <h2>Transaction History</h2>
    </div>
    {% if transactions %}
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Date & Time</th>
                    <th>Type</th>
                    <th>Amount</th>
                    <th>Balance After</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                {% for transaction in transactions %}
                <tr>
                    <td>{{ transaction.created_at|date:"M d, Y H:i" }}</td>
                    <td>
                        <span class="badge {% if transaction.transaction_type in 'deposit,bet_won,refund' %}badge-credit{% else %}badge-debit{% endif %}">
                            {{ transaction.get_transaction_type_display }}
                        </span>
                    </td>
                    <td class="{% if transaction.transaction_type in 'deposit,bet_won,refund' %}amount-positive{% else %}amount-negative{% endif %}">
                        {% if transaction.transaction_type in 'deposit,bet_won,refund' %}+{% else %}-{% endif %}₹{{ transaction.amount|floatformat:2 }}
                    </td>
                    <td>₹{{ transaction.balance_after|floatformat:2 }}</td>
                    <td>{{ transaction.description|default:"-" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div style="padding: 60px; text-align: center; color: #718096;">
        <p>No transactions found</p>
    </div>
    {% endif %}
</div>
{% endblock %}



